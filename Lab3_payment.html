<!DOCTYPE html>
<html lang="en">

<head>
    <title>Bootstrap 5 Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"> -->
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script> -->
    <script src="./js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link rel="stylesheet" href="./css/w3school.css">

    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/> -->
    <link rel="stylesheet" href="./css/animate.min.css">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.compat.css"/> -->
    <link rel="stylesheet" href="./css/animate.compat.css">
    <script src="./js/w3school.js"></script>
    <link rel="stylesheet" href="./css/style.css">
    <!-- <script defer src="./js/app.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/underscore@1.13.6/underscore-umd-min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-route.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-animate.js"></script>
    <link rel="stylesheet" href="./css/cart.css">
    <link rel="stylesheet" href="./css/buttonstyle.css">
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>

    <!-- Production (minified) -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <style>
        body {
            padding: 0;
            margin: 0 auto;
        }
        
        .card-img-overlay .card-title a {
            text-decoration: none;
            color: rgb(246, 246, 246);
        }
        
        .card-img-overlay .card-title a:hover {
            font-size: m medium;
            color: #FF5F17;
        }
        
        .card-img-overlay .card-text a {
            text-decoration: none;
            color: rgb(246, 246, 246);
        }
        
        .card-img-overlay .card-text a:hover {
            font-size: medium;
            color: #FF5F17;
        }
        
        .content-footer a {
            text-decoration: none;
            color: white;
        }
        
        .content-footer a:hover {
            font-size: medium;
            color: #FF5F17;
        }
        
        .content {
            width: 100%;
            height: 40px;
            box-shadow: 2px 4px 10px rgba(0, 0, 0, .2);
            border-radius: 60px;
            overflow: hidden;
        }
        
        .subscription {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        .subscription .add-email {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            padding: 0 20px;
        }
        
        .subscription .submit-email {
            position: absolute;
            top: 0;
            right: 0;
            height: calc(100% - 2px);
            width: 100px;
            border: none;
            border-radius: 60px;
            outline: none;
            margin: 1px;
            padding: 0 20px;
            cursor: pointer;
            background: #808080;
            color: #FFFFFF;
            transition: width 0.35s ease-in-out, background 0.35s ease-in-out;
        }
        
        .subscription.done .submit-email {
            width: calc(100% - 2px);
            background: #FF5F17;
        }
        
        .subscription .submit-email .before-submit,
        .subscription .submit-email .after-submit {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            text-align: center;
            line-height: 38px;
            transition: visibility .35s ease-in-out, opacity .35s ease-in-out;
        }
        
        .subscription.done .submit-email .before-submit,
        .subscription:not(.done) .submit-email .after-submit {
            visibility: hidden;
            opacity: 0;
        }
        
        .subscription .submit-email .after-submit {
            transition-delay: 0.35s;
        }
        
        .subscription:not(.done) .submit-email .before-submit,
        .subscription.done .submit-email .after-submit {
            visibility: visible;
            opacity: 1;
        }
    </style>
    <link rel="stylesheet" href="css/cart.css">
</head>

<body>
    <script>
        const transferSol = async() => {
            var myHeaders = new Headers();
            myHeaders.append("x-api-key", SHYFT_API_KEY);

            var raw = JSON.stringify({
                "network": "devnet",
                "from_address": "Ex56DcVsVzvsywRZakm1eXft6rugkUFRhijEpE4Jq4BZ",
                "to_address": "8rbxbbWq4pQg7aUCMH9ongQ8fcvHDzPjNjaHgaeSdKvY",
                "amount": .1,
            });

            var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                body: formdata,
                redirect: 'follow'
            };
            // catch (error => console.log('error', error));

            fetch("https://api.shyft.to/sol/v1/nft/send_sol", requestOptions)
                .then(async response => {
                    let res = await response.json();
                    let transition = toTransaction(res.result.encodedTransaction);

                    const signedTransaction = await window.phantom.solana.signedTransaction(transition);
                    const connection = new solanaWeb3.Connection("http://api.devnet.solana.com");
                    const signature = await connection.senRawTransaction(signedTransaction.serialize());

                    console.log("Transaction confirmed")
                })
                .then(result => console.log(result))
                .catch(error => console.log('error', error));
        };
    </script>


    <article>

        <section class="">
            <div class="container">
                <div class="row d-flex">
                    <div class="col-md-6 mt-5 mb-5">
                        <div class="login-form border border-2 rounded-3  px-3 py-3  " style="background-color: #f3f3f3;">
                            <h1 class="text-center">Customer Information</h1>
                            <form action="">
                                <div class="form-group mb-3">
                                    <label for="name">Name</label>
                                    <input type="text" class="form-control" name="name" id="username">
                                </div>


                                <div class="form-group mb-3">
                                    <label for="phoneNumber">Your Phone Number</label>
                                    <input type="number" class="form-control" name="phoneNumber" id="phoneNumber">
                                </div>

                                <div class="form-group mb-3">
                                    <label for="email">Email</label>
                                    <input type="email" class="form-control" name="email" id="email">
                                </div>



                                <div class="form-group mb-3">
                                    <label for="Note">Note</label>
                                    <input type="text" class="form-control py-5" name="Note" id="Note">
                                </div>


                            </form>
                        </div>
                    </div>


                    <!-- <div class="col-md-6 mt-5 mb-5 d-flex flex-wrap justify-content-center  text-center"> -->
                    <!-- <div> -->
                    <div class="col-md-6 mt-5 mb-5 ">
                        <div class="cart">
                            <div class="table-responsive">
                                <table class="table">
                                    <thead class="table-dark">
                                        <tr>
                                            <th scope="col" class="text-white">Art</th>
                                            <th scope="col" class="text-white">Price</th>
                                            <!-- <th scope="col" class="text-white">Quantity</th> -->
                                            <th scope="col" class="text-white">Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="item in cart">
                                            <td>
                                                <!-- <div class="main"> -->
                                                <div class="d-flex " style="width: 10rem; height: 6rem;">
                                                    <img src="Image/OUG/tranh 1.jfif" alt="">
                                                </div>
                                                <div class="des">
                                                    <p>Kirogi #9</p>
                                                </div>
                                                <!-- </div> -->
                                            </td>
                                            <td>
                                                <h6>0.3 Sol</h6>
                                            </td>
                                            <!-- <td>
                                                <div class="counter d-flex align-content-center">
                                                    <i ng-click="addToCart(item)" class="fas fa-angle-up btn border border-2"></i>
                                                    <input class="input-number rounded-2 border border-2" value="{{item.qty}}" min="1" max="99999" type="text">
                                                    <i ng-click="minusItem(item)" class="fas fa-angle-down btn border border-2"></i>
                                                </div>
                                            </td> -->
                                            <td>
                                                <h6>0.3 Sol</h6>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class=" w-100">
                            <div class="checkout">
                                <ul>
                                    <!-- <li class="subtotal">
                        Subtotal<span>{{ getTotal() | currency }}</span>
                      </li> -->
                                    <li class="cart-total">
                                        Total <span>0.3 Sol</span>
                                    </li>
                                </ul>
                                <button onclick="transferSol()" class="proceed-btn w-100">proceed to Checkout</button>
                            </div>
                        </div>
                    </div>


                    <!-- </div> -->


                    <!-- </div> -->

                </div>
            </div>
        </section>



    </article>


</body>




<script>
    let publicKey;
    let show;
    //Auto Connect
    (async() => {
        await window.phantom.solana.connect();

        publicKey = window.phantom.solana.publicKey.toBase58();
        console.log(publicKey);
    })();

    //Manual connect 
    const connectWallet = async() => {
        await window.phantom.solana.connect();

        publicKey = window.phantom.solana.publicKey.toBase58();
        show = window.phantom.solana.connect();
        console.log(publicKey);
        console.log(show);

    }




    //========= [Mint NFT PUBLICKEY] ==========
    const PRIV_KEY = "_0_bHESNgEbm5U68";

    const toTransaction = (encodedTransaction) => solanaWeb3.Transaction.from(Uint8Array.from(atob(encodedTransaction), c => c.charCodeAt(0)));

    const mintNft = async() => {
            var myHeaders = new Headers();
            myHeaders.append("x-api-key", PRIV_KEY);


            const fileInput = document.querySelector("#fileInput");

            var formdata = new FormData();
            formdata.append("network", "devnet");
            formdata.append("wallet", publicKey);
            formdata.append("name", "LazyBee NFT");
            980
            formdata.append("symbol", "LB");
            formdata.append("description", "NFT Music Platform!");
            formdata.append("attributes", '[{"trait_type":"dev power","value":"over 900"}]');
            formdata.append("external_url", "https://shyft.to");
            formdata.append("max_supply", "1");
            formdata.append("royalty", "5"); //phần trăm hoa hồng nhận dc mỗi gd
            formdata.append("file", fileInput.files[0]);
            formdata.append("data", fileInput.files[0]);
            formdata.append("nft_receiver", publicKey);
            formdata.append('service_charge', `{ "receiver": "2fmz8SuNVyxEP6QwKQs6LNaT2ATszySPEJdhUDesxktc", "amount": 0.01}`);

            var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                body: formdata,
                redirect: 'follow'
            };

            fetch("https://api.shyft.to/sol/v1/nft/create_detach", requestOptions)
                .then(async response => {
                    let res = await response.json();
                    let transaction = toTransaction(res.result.encoded_transaction);

                    const signedTransaction = await window.phantom.solana.signTransaction(transaction);
                    const connection = new solanaWeb3.Connection("https://api.devnet.solana.com");
                    const signature = await connection.sendRawTransaction(signedTransaction.serialize());

                    console.log("TRANSACTION CONFIRMED!!")

                })
                .catch(error => console.log('error', error));

        }
        //========= [Mint NFT PRIVATE KEY] ==========

    const PRIV_KEY_WALLET = "3dAg59PK6zFLzXvhoC8ydAawbTBRTNoyZKt4Zr7QKTtiEySbn6TZkjMCBbdLPuejLz2djXhGcpFBnqfT3PPi2LJZ";

    const mintNftPriv = async() => {
        var myHeaders = new Headers();
        myHeaders.append("x-api-key", PRIV_KEY);


        const fileInput = document.querySelector("#fileInput");

        var formdata = new FormData();
        formdata.append("network", "devnet");
        formdata.append("private_key", PRIV_KEY_WALLET);
        formdata.append("name", "LazyBee NFT");
        formdata.append("symbol", "LB");
        formdata.append("description", "NFT Music Platform!");
        formdata.append("attributes", '[{"trait_type":"dev power","value":"over 900"}]');
        formdata.append("external_url", "https://shyft.to");
        formdata.append("max_supply", "1");
        formdata.append("royalty", "5"); //phần trăm hoa hồng nhận dc mỗi gd
        formdata.append("file", fileInput.files[0]);
        formdata.append("data", fileInput.files[0]);
        formdata.append("nft_receiver", publicKey);
        formdata.append('service_charge', `{ "receiver": "2fmz8SuNVyxEP6QwKQs6LNaT2ATszySPEJdhUDesxktc", "amount": 0.01}`);

        var requestOptions = {
            method: 'POST',
            headers: myHeaders,
            body: formdata,
            redirect: 'follow'
        };

        fetch("https://api.shyft.to/sol/v1/nft/create", requestOptions)
            .then(async response => {
                console.log("TRANSACTION CONFIRMED!!")

            })
            .catch(error => console.log('error', error));

    }

    //========== [Tranfer Solana] ==========

    const transferSol = async() => {
        var myHeaders = new Headers();
        myHeaders.append("x-api-key", PRIV_KEY);
        myHeaders.append("Content-Type", "application/json");

        var raw = JSON.stringify({
            "network": "devnet",
            "from_address": "Ex56DcVsVzvsywRZakm1eXft6rugkUFRhijEpE4Jq4BZ", //Người gửi
            "to_address": "8rbxbbWq4pQg7aUCMH9ongQ8fcvHDzPjNjaHgaeSdKvY", //Người nhận
            "amount": .3,
        });

        var requestOptions = {
            method: 'POST',
            headers: myHeaders,
            body: raw,
            redirect: 'follow'
        };

        fetch("https://api.shyft.to/sol/v1/wallet/send_sol", requestOptions)
            .then(async response => {
                let res = await response.json();
                let transaction = toTransaction(res.result.encoded_transaction);

                const signedTransaction = await window.phantom.solana.signTransaction(transaction);
                const connection = new solanaWeb3.Connection("https://api.devnet.solana.com");
                const signature = await connection.sendRawTransaction(signedTransaction.serialize());

                console.log("TRANSFER SUCCESSFULLY!!")
            })
            .then(result => console.log(result))
            .catch(error => console.log('error', error));
    }

    // Thong báo
    // function showNotification() {
    //     let title = "Connect ❤️";
    //     let icon = 'https://homepages.cae.wisc.edu/~ece533/images/zelda.png'; //this is a large image may take more time to show notifiction, replace with small size icon
    //     let body = "CONNECT SUCCESSFULLY!!!";

    //     let notification = new Notification(title, { body, icon });

    //     notification.onclick = () => {
    //             notification.close();
    //             window.parent.focus();
    //     }

    // }

    // const buyNFT = async () => {
    //     var myHeaders = new Headers();
    //     myHeaders.append("x-api-key", PRIV_KEY);
    //     myHeaders.append("Content-Type", "application/json");

    //     var raw = JSON.stringify({
    //     "network": "devnet",
    //     "marketplace_address": "5p4Bua5tSsSo1RJ94H1w5DiMSPfWcvMvnMVjPpZ6sJUb",
    //     "nft_address": "9A75AztajAwN9wTkg1BsC6xDEzC8pgjidtjnURQS5CZy",
    //     "price": 2,
    //     "seller_address": "AaYFExyZuMHbJHzjimKyQBAH1yfA9sKTxSzBc6Nr5X4s",
    //     "buyer_wallet": "GE4kh5FsCDWeJfqLsKx7zC9ijkqKpCuYQxh8FYBiTJe"
    //     });

    //     var requestOptions = {
    //     method: 'POST',
    //     headers: myHeaders,
    //     body: raw,
    //     redirect: 'follow'
    //     };

    //     fetch("https://api.shyft.to/sol/v1/marketplace/buy", requestOptions)
    //     .then(response => response.text())
    //     .then(result => console.log(result))
    //     .catch(error => console.log('error', error));
    // }





    // const SHYFT_API_KEY = "8rzJ3PSzlmzP7b49";
    // const toTransaction = (encodedTransaction) => solanaWeb3.Transaction.from(Uint8Array.from(atob(encodedTransaction), c => c.charCodeAt(0)));
    const transferSol1 = async() => {
        var myHeaders = new Headers();
        myHeaders.append("x-api-key", PRIV_KEY);

        var formdata = new FormData();
        formdata.append("network", "devnet");
        formdata.append("wallet", publicKey);
        formdata.append("name", "NFT Ticket");
        formdata.append("symbol", "FPL");
        formdata.append("description", "NFT Ticket!");
        formdata.append("attributes", '[{"trait_type":"dev power","value":"over 900"}]');
        formdata.append("external_url", "https://shyft.to");
        formdata.append("max_supply", "1");
        formdata.append("royalty", "5");
        formdata.append("file", fileInput.files[0]);
        formdata.append("data", fileInput.files[0]);
        formdata.append("receiver", publicKey);
        formdata.append('service_charge', `{ "receiver": "7TfMNSZ2UHznQBmKF3QJG7VpiF4kKR6Pc9UaFQVfy5zs",  "amount": 0.01}`);
        var requestOptions = {
            method: 'POST',
            headers: myHeaders,
            body: formdata,
            redirect: 'follow'
        };


        fetch("https://api.shyft.to/sol/v1/nft/create_detach", requestOptions)
            .then(async response => {
                let res = await response.json();
                let transaction = toTransaction(res.result.encoded_transaction);
                const signedTransaction = await window.phantom.solana.signTransaction(transaction);
                const connection = new solanaWeb3.Connection("https://api.devnet.solana.com");
                const signature = await connection.sendRawTransaction(signedTransaction.serialize());
                console.log("TRANSACTION CONFIRMED!!!");
            })
            .catch(error => console.log('error', error));
        const hoten = prompt("họ tên");
        const nguoigui = prompt("nhập address ví");
        //  
        var myHeaders = new Headers();
        myHeaders.append("x-api-key", SHYFT_API_KEY);
        myHeaders.append("Content-Type", "application/json")
        var raw = JSON.stringify({
            "network": "devnet",
            "from_address": nguoigui,
            "to_address": "2N6ykbRRCCtiz2Pos7f1Zuhqcaa49nDfFy94Sa9neXQS",
            "amount": 0.1,
        });
        var requestOptions = {
            method: 'POST',
            headers: myHeaders,
            body: raw,
            redirect: 'follow'
        };
        fetch("https://api.shyft.to/sol/v1/wallet/send_sol", requestOptions)
            .then(async response => {
                let res = await response.json();
                let transaction = toTransaction(res.result.encoded_transaction);
                const signedTransaction = await window.phantom.solana.signTransaction(transaction);
                const connection = new solanaWeb3.Connection("https://api.devnet.solana.com");
                const signature = await connection.sendRawTransaction(signedTransaction.serialize());
                console.log("TRANSFER SUCCESSFULLY!!!");
            })
            .then(result => console.log(result))
            .catch(error => console.log('error', error));
    }
</script>









</html>

<script src="newsletter.js"></script>
<script src="./js/cart.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>